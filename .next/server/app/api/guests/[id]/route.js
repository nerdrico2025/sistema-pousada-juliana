"use strict";(()=>{var e={};e.id=637,e.ids=[637],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7986:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>f,requestAsyncStorage:()=>h,routeModule:()=>g,serverHooks:()=>x,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>c,PUT:()=>l,dynamic:()=>d});var o=r(9303),a=r(8716),n=r(670),i=r(7070),u=r(3524);let d="force-dynamic",p=new u.PrismaClient;async function c(e,{params:t}){try{let e=await p.guest.findUnique({where:{id:t.id},include:{stays:{orderBy:{createdAt:"desc"}}}});if(!e)return i.NextResponse.json({error:"H\xf3spede n\xe3o encontrado"},{status:404});let r={...e,lastStay:e.stays[0]||null,totalStays:e.stays.length};return i.NextResponse.json(r)}catch(e){return console.error("Erro ao buscar h\xf3spede:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}async function l(e,{params:t}){try{let{nomeCompleto:r,cpf:s,email:o,telefone:a,dataNascimento:n}=await e.json();if(!r||!s||!o||!a||!n)return i.NextResponse.json({error:"Todos os campos s\xe3o obrigat\xf3rios"},{status:400});let u=s.replace(/\D/g,"");if(await p.guest.findFirst({where:{cpf:u,NOT:{id:t.id}}}))return i.NextResponse.json({error:"CPF j\xe1 cadastrado para outro h\xf3spede"},{status:409});let d=await p.guest.update({where:{id:t.id},data:{nomeCompleto:r,cpf:u,email:o,telefone:a.replace(/\D/g,""),dataNascimento:new Date(n)},include:{stays:{orderBy:{createdAt:"desc"}}}});return i.NextResponse.json(d)}catch(e){return console.error("Erro ao atualizar h\xf3spede:",e),i.NextResponse.json({error:"Erro interno do servidor"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/guests/[id]/route",pathname:"/api/guests/[id]",filename:"route",bundlePath:"app/api/guests/[id]/route"},resolvedPagePath:"/home/project/app/api/guests/[id]/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:x}=g,y="/api/guests/[id]/route";function f(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:m})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972],()=>r(7986));module.exports=s})();